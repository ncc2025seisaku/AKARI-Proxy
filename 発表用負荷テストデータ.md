# 発表用負荷テストデータ

- 実行日時: 2025-12-01, コマンド: `uv run --python 3.11 python loadtest/disaster_suite.py --demo-server --no-event-log --host 127.0.0.1 --port 14600 --scenario baseline_demo --scenario delay_loss_extreme --scenario jitter_spike --scenario burst_traffic --scenario flap_harsh --scenario mtu_variation_like --scenario gz_large_body`
- 環境: ローカル demo-server（127.0.0.1:14600）で完結。外部通信なし。PSK はローカル用。
- 出力ログ: `logs/disaster_suite_summary.json` と `logs/disaster_suite_history.jsonl`

## シナリオ別ざっくり結果（誰でもわかる言葉）

- ベースライン（普通の状態）  
  80 回中 80 回成功（100%）。平均 0.003 秒で返答。かなり余裕あり。

- 超遅延 + 20% ロス（遅延 3 秒、ロス 20%、ジッター 300ms 相当）  
  200 回中 168 回成功（約 84%）、32 回タイムアウト。平均 0.15 秒。大遅延でも 8 割は取れるが、残りはタイムアウト。

- ジッター大（350ms 揺れ）  
  200 回中 200 回成功（100%）。平均 0.17 秒。順序揺れや再送暴走は発生せず完走。

- バースト高並列（800 リクエスト、軽い 5% ロス）  
  800 回中 754 回成功（約 94%）、46 回タイムアウト。平均 0.009 秒。大量同時でもほぼ捌けるが、軽ロス下で一部落ち。

- 強めの断続断（1.3 秒ごとに 0.25 秒遮断 + ロス 5%）  
  200 回中 11 回成功（約 6%）、189 回タイムアウト。断続的な遮断が多いと回復にかなり苦戦。

- MTU 揺れ近似（受信バッファ 1400, ロス 5%, ジッター 50ms）  
  240 回中 232 回成功（約 97%）、8 回タイムアウト。小さめ MTU を想定してもほぼ完走。

- 巨大レスポンス 10MB（デコンプ/転送負荷確認用）  
  60 回中 0 回成功。`payload size 130000008 exceeds u16::MAX` でエンコードできず全件失敗。10MB 級は分割・ストリーミング前提にする必要あり。

## ひとことで
- ローカル環境では「遅延・ロス・ジッター・MTU揺れ・バースト」は概ね想定内で捌けた。  
- 断続断（フラップ）は現状弱く、対策強化が必要。  
- 超大容量レスポンスは現行の固定チャンク前提だと送れないので分割実装が要る。
